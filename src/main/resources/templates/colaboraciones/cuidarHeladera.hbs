{{#partial "contenido"}}
    <section class="row g-2 gx-4 flex-grow-1 mt-5 ms-sm-5 me-sm-5 mt-3 ms-3 me-3">
        <nav class="col-md-4 p-4  sidebar border border-color-999 rounded-4">
            <h1 class="fs-3 mt-3 mb-5">Encargarse de heladera</h1>
            <form class="mt-5" method="POST" action="/heladeras">

                <h4 class="fw-bold fs-5 mb-2">Información básica</h4>
                <p class="mb-2">Ingresar los datos básicos de la heladera.</p>
                <div class="col-12 mb-2">
                    <input type="text" class="w-100" name="nombre" placeholder="Nombre" value="{{nombre}}" required>
                </div>
                <div class="col-12 mb-2">
                    <input type="number" class="w-100" name="capacidadMaximaViandas" placeholder="Cantidad máxima de viandas" value="{{capacidadMaximaViandas}}" min="1" required>
                </div>

                <h4 class="fw-bold fs-5 mt-4 mb-2">Dirección</h4>
                <p class="mb-2">La dirección es un campo obligatorio. Por favor, asegúrese de completarlo correctamente.</p>
                <div class="col mb-2">
                    <select id="provinciaSelect" name="provincia" class="form-select border-999 rounded-10 py-2 w-100 custom-select" required
                            hx-post="/municipios"
                            hx-target="#municipioSelect"
                            hx-trigger="change">
                        <option value="" selected>Provincia</option>
                        {{#each provincias}}
                            <option value="{{this.provincia}}" {{#ifEqual provinciaEdit this.provincia}}selected{{/ifEqual}}>{{this.provincia}}</option>
                        {{/each}}
                    </select>
                </div>
                <div class="col mb-2">
                    <select id="municipioSelect" name="municipio" class="form-select border-999 rounded-10 py-2 w-100 custom-select" required>
                        <option value="" selected>Municipio</option>
                    </select>
                </div>
                <div class="col mb-2">
                    <input type="text" class="w-100" name="calle" placeholder="Calle" value="{{calle}}" required>
                </div>
                <div class="col mb-2">
                    <input type="number" class="w-100" name="altura" placeholder="Altura" min="1" step="1" value="{{altura}}" required>
                </div>

                <h4 class="fw-bold mt-4 fs-5 mb-2">Información secundaria</h4>
                <p class="mb-2">Estos datos sobre la heladera no son obligatorios, pero en caso de indicarlos, asegúrese de que la temperatura esperada esté indicada en grados Celsius.</p>
                <div class="col-12 mt-2">
                    <div class="input-group">
                        <div class="input-group-text selection">Modelo</div>
                        <select name="modelo" class="custom-select">
                            <option value="" selected>Desconocido</option>>
                            {{#each modelos}}
                                <option value="{{this.id}}" {{#ifEqual modeloEdit this.modelo}}selected{{/ifEqual}}>{{this.modelo}}</option>
                            {{/each}}
                        </select>
                    </div>
                </div>
                <div class="col-12 mt-2">
                    <input type="number" name="temperaturaEsperada" class="w-100" placeholder="Temperatura esperada (en Celsius)" value="{{temperaturaEsperada}}" step="0.1">
                </div>
                <div class="col-12 mt-3">
                    <button class="w-100" type="submit">Encargarse</button>
                </div>

                {{#if error}}
                    <div class="row mt-2 justify-content-center">
                        <p id="error" class="error text-center">{{error}}</p>
                    </div>
                {{/if}}

                <div class="col-12 mt-5 mb-3 text-center">
                    <hr>
                    <label class="grey-text fw-bold w-100">
                        <hr>
                        ¿No estás seguro de dónde colocar tu heladera?
                        <a href="/heladeras/recomendacion" class="light-blue">Te sugerimos los mejores puntos</a>.
                    </label>
                </div>
            </form>
        </nav>
        <main class="col-md-8 d-flex flex-column">
            <div id="map"></div>
        </main>
    </section>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var heladeras = {{{this.jsonHeladeras}}}
            addMarkers(heladeras, function(){
                // llena nombre e id en el campo de la heladera que tenga focus
                var lv_input = $(":focus[id^='heladera']");
                if (lv_input !== undefined) {
                    lv_input.val(this.heladera.nombre);
                    $("#"+lv_input.data("id")).val(this.heladera.id);
                }
            });
        });
    </script>
    <script src="https://unpkg.com/htmx.org@2.0.2" integrity="sha384-Y7hw+L/jvKeWIRRkqWYfPcvVxHzVzn5REgzbawhxAuQGwX1XWe70vji+VSeHOThJ" crossorigin="anonymous"></script>
{{/partial}}

{{> templates/base titulo="Encargarse de una heladera" mostrarMapa=true mostrarSeccion=true seccion="Encargarse de una heladera" mostrarPersonaJuridica=true mostrarIrAtras=true paginaAtras="/" }}
